from .ui_manager import *

print("Running ui_manager test")

current = {
    "state": {
        "yeeha": 45,
        "a": 1,
        "b": 2,
        "c": {
            "d": 3,
            "e": 4
        },
        "f": 5
    }
}    


# current = {"TYPE": "CHANNEL_SUBSCRIPTION_UPDATE", "update": {"channel": "5cdfe6bc-d74e-4b6c-8cc2-a3d94ff77c8c", "channel_owner": "75ec5702-4081-4579-9884-a311b19e7186", "channel_name": "ui_state", "message": "ae074ce3-d555-45e1-aac5-f73878b45967", "type": "base", "agent": "75ec5702-4081-4579-9884-a311b19e7186", "timestamp": 1713338772.825155, "payload": {"state": {"state": None, "type": "uiContainer", "name": None, "displayString": "Pump 1: Isolator off;Pump 2: Isolator off;Pump 3: Isolator off", "statusIcon": "idle", "children": {"significantEvent": {"type": "uiAlertStream", "name": "significantEvent", "displayString": "Notify Me Of Any Changes"}, "pump1_submodule": {"type": "uiSubmodule", "name": "pump1_submodule", "displayString": "Pump 1", "children": {"pump1pumprpm": {"type": "uiVariable", "name": "pump1pumprpm", "displayString": "Engine RPM", "form": "radialGauge", "varType": "float", "decPrecision": 0, "ranges": [{"label": None, "min": 0, "max": 800, "colour": "blue", "showOnGraph": True}, {"label": None, "min": 800, "max": 2200, "colour": "green", "showOnGraph": True}]}, "pump1pumpprime": {"type": "uiVariable", "name": "pump1pumpprime", "displayString": "Pump Primed", "varType": "bool"}, "pump1engineLoad": {"type": "uiVariable", "name": "pump1engineLoad", "displayString": "Engine Load (%)", "varType": "float", "decPrecision": 0, "ranges": [{"label": None, "min": 0, "max": 15, "colour": "blue", "showOnGraph": True}, {"label": None, "min": 15, "max": 100, "colour": "green", "showOnGraph": True}]}, "pump1coolantTemp": {"type": "uiVariable", "name": "pump1coolantTemp", "displayString": "Coolant Temp (C)", "varType": "float", "decPrecision": 0, "ranges": [{"label": "Cool", "min": 0, "max": 50, "colour": "blue", "showOnGraph": True}, {"label": "Good", "min": 50, "max": 90, "colour": "green", "showOnGraph": True}, {"label": "Hot", "min": 90, "max": 120, "colour": "yellow", "showOnGraph": True}]}, "pump1fuelRate": {"type": "uiVariable", "name": "pump1fuelRate", "displayString": "Fuel Rate (l/hr)", "varType": "float", "decPrecision": 1}, "pump1sysVolts": {"type": "uiVariable", "name": "pump1sysVolts", "displayString": "System Voltage", "varType": "float", "decPrecision": 1, "currentValue": 12.2}, "pump1engineHours": {"type": "uiVariable", "name": "pump1engineHours", "displayString": "Engine Hours", "varType": "float", "decPrecision": 1}, "pump1pumpState": {"type": "uiStateCommand", "name": "pump1pumpState", "displayString": "Pump Should Be", "verboseString": "Pump 1", "userOptions": {"shutdown": {"type": "uiElement", "name": "shutdown", "displayString": "Shutdown"}, "running": {"type": "uiElement", "name": "running", "displayString": "Running"}}}, "pump1pumpTargetRPM": {"type": "uiFloatParam", "name": "pump1pumpTargetRPM", "displayString": "Target RPM", "verboseString": "Pump 1 RPM", "min": 800, "max": 2000}}}, "pump2_submodule": {"type": "uiSubmodule", "name": "pump2_submodule", "displayString": "Pump 2", "children": {"pump2pumprpm": {"type": "uiVariable", "name": "pump2pumprpm", "displayString": "Engine RPM", "form": "radialGauge", "varType": "float", "decPrecision": 0, "ranges": [{"label": None, "min": 0, "max": 800, "colour": "blue", "showOnGraph": True}, {"label": None, "min": 800, "max": 2200, "colour": "green", "showOnGraph": True}]}, "pump2pumpprime": {"type": "uiVariable", "name": "pump2pumpprime", "displayString": "Pump Primed", "varType": "bool"}, "pump2engineLoad": {"type": "uiVariable", "name": "pump2engineLoad", "displayString": "Engine Load (%)", "varType": "float", "decPrecision": 0, "ranges": [{"label": None, "min": 0, "max": 15, "colour": "blue", "showOnGraph": True}, {"label": None, "min": 15, "max": 100, "colour": "green", "showOnGraph": True}]}, "pump2coolantTemp": {"type": "uiVariable", "name": "pump2coolantTemp", "displayString": "Coolant Temp (C)", "varType": "float", "decPrecision": 0, "ranges": [{"label": "Cool", "min": 0, "max": 50, "colour": "blue", "showOnGraph": True}, {"label": "Good", "min": 50, "max": 90, "colour": "green", "showOnGraph": True}, {"label": "Hot", "min": 90, "max": 120, "colour": "yellow", "showOnGraph": True}]}, "pump2fuelRate": {"type": "uiVariable", "name": "pump2fuelRate", "displayString": "Fuel Rate (l/hr)", "varType": "float", "decPrecision": 1}, "pump2sysVolts": {"type": "uiVariable", "name": "pump2sysVolts", "displayString": "System Voltage", "varType": "float", "decPrecision": 1}, "pump2engineHours": {"type": "uiVariable", "name": "pump2engineHours", "displayString": "Engine Hours", "varType": "float", "decPrecision": 1}, "pump2pumpState": {"type": "uiStateCommand", "name": "pump2pumpState", "displayString": "Pump Should Be", "verboseString": "Pump 2", "userOptions": {"shutdown": {"type": "uiElement", "name": "shutdown", "displayString": "Shutdown"}, "running": {"type": "uiElement", "name": "running", "displayString": "Running"}}}, "pump2pumpTargetRPM": {"type": "uiFloatParam", "name": "pump2pumpTargetRPM", "displayString": "Target RPM", "verboseString": "Pump 2 RPM", "min": 800, "max": 2000}}}, "pump3_submodule": {"type": "uiSubmodule", "name": "pump3_submodule", "displayString": "Pump 3", "children": {"pump3pumprpm": {"type": "uiVariable", "name": "pump3pumprpm", "displayString": "Engine RPM", "form": "radialGauge", "varType": "float", "decPrecision": 0, "ranges": [{"label": None, "min": 0, "max": 800, "colour": "blue", "showOnGraph": True}, {"label": None, "min": 800, "max": 2200, "colour": "green", "showOnGraph": True}]}, "pump3pumpprime": {"type": "uiVariable", "name": "pump3pumpprime", "displayString": "Pump Primed", "varType": "bool"}, "pump3engineLoad": {"type": "uiVariable", "name": "pump3engineLoad", "displayString": "Engine Load (%)", "varType": "float", "decPrecision": 0, "ranges": [{"label": None, "min": 0, "max": 15, "colour": "blue", "showOnGraph": True}, {"label": None, "min": 15, "max": 100, "colour": "green", "showOnGraph": True}]}, "pump3coolantTemp": {"type": "uiVariable", "name": "pump3coolantTemp", "displayString": "Coolant Temp (C)", "varType": "float", "decPrecision": 0, "ranges": [{"label": "Cool", "min": 0, "max": 50, "colour": "blue", "showOnGraph": True}, {"label": "Good", "min": 50, "max": 90, "colour": "green", "showOnGraph": True}, {"label": "Hot", "min": 90, "max": 120, "colour": "yellow", "showOnGraph": True}]}, "pump3fuelRate": {"type": "uiVariable", "name": "pump3fuelRate", "displayString": "Fuel Rate (l/hr)", "varType": "float", "decPrecision": 1}, "pump3sysVolts": {"type": "uiVariable", "name": "pump3sysVolts", "displayString": "System Voltage", "varType": "float", "decPrecision": 1}, "pump3engineHours": {"type": "uiVariable", "name": "pump3engineHours", "displayString": "Engine Hours", "varType": "float", "decPrecision": 1}, "pump3pumpState": {"type": "uiStateCommand", "name": "pump3pumpState", "displayString": "Pump Should Be", "verboseString": "Pump 3", "userOptions": {"shutdown": {"type": "uiElement", "name": "shutdown", "displayString": "Shutdown"}, "running": {"type": "uiElement", "name": "running", "displayString": "Running"}}}, "pump3pumpTargetRPM": {"type": "uiFloatParam", "name": "pump3pumpTargetRPM", "displayString": "Target RPM", "verboseString": "Pump 3 RPM", "min": 800, "max": 2000}}}}}}}}


desired = {
    "state": {
        "yeeha": None,
        "yooo": None,
        "a": 1,
        "b": {
            "x": 1,
            "y": 2
        },
        "c": {
            "e": "Yep",
        },
        "f": [
            1,2,3
        ]
    },
    "state2": {
        "g": 7,
        "h": 8
    }
}

# desired = {"TYPE": "CHANNEL_SUBSCRIPTION_UPDATE", "update": {"channel": "5cdfe6bc-d74e-4b6c-8cc2-a3d94ff77c8c", "channel_owner": "75ec5702-4081-4579-9884-a311b19e7186", "channel_name": "ui_state", "message": "ae074ce3-d555-45e1-aac5-f73878b45967", "type": "base", "agent": "75ec5702-4081-4579-9884-a311b19e7186", "timestamp": 1713338772.825155, "payload": {"state": {"state": None, "type": "uiContainer", "name": None, "displayString": "Pump 1: Isolator off;Pump 2: Isolator off;Pump 3: Isolator off", "statusIcon": "idle", "children": {"significantEvent": {"type": "uiAlertStream", "name": "significantEvent", "displayString": "Notify Me Of Any Changes"}, "pump1_submodule": {"type": "uiSubmodule", "name": "pump1_submodule", "displayString": "Pump 1", "children": {"pump1pumprpm": {"type": "uiVariable", "name": "pump1pumprpm", "displayString": "Engine RPM", "form": "radialGauge", "varType": "float", "decPrecision": 0, "currentValue": None, "ranges": [{"label": None, "min": 0, "max": 800, "colour": "blue", "showOnGraph": True}, {"label": None, "min": 800, "max": 2200, "colour": "green", "showOnGraph": True}]}, "pump1pumpprime": {"type": "uiVariable", "name": "pump1pumpprime", "displayString": "Pump Primed", "varType": "bool"}, "pump1engineLoad": {"type": "uiVariable", "name": "pump1engineLoad", "displayString": "Engine Load (%)", "varType": "float", "decPrecision": 0, "ranges": [{"label": None, "min": 0, "max": 15, "colour": "blue", "showOnGraph": True}, {"label": None, "min": 15, "max": 100, "colour": "green", "showOnGraph": True}]}, "pump1coolantTemp": {"type": "uiVariable", "name": "pump1coolantTemp", "displayString": "Coolant Temp (C)", "varType": "float", "decPrecision": 0, "ranges": [{"label": "Cool", "min": 0, "max": 50, "colour": "blue", "showOnGraph": True}, {"label": "Good", "min": 50, "max": 90, "colour": "green", "showOnGraph": True}, {"label": "Hot", "min": 90, "max": 120, "colour": "yellow", "showOnGraph": True}]}, "pump1fuelRate": {"type": "uiVariable", "name": "pump1fuelRate", "displayString": "Fuel Rate (l/hr)", "varType": "float", "decPrecision": 1}, "pump1sysVolts": {"type": "uiVariable", "name": "pump1sysVolts", "displayString": "System Voltage", "varType": "float", "decPrecision": 1}, "pump1engineHours": {"type": "uiVariable", "name": "pump1engineHours", "displayString": "Engine Hours", "varType": "float", "decPrecision": 1}, "pump1pumpState": {"type": "uiStateCommand", "name": "pump1pumpState", "displayString": "Pump Should Be", "verboseString": "Pump 1", "userOptions": {"shutdown": {"type": "uiElement", "name": "shutdown", "displayString": "Shutdown"}, "running": {"type": "uiElement", "name": "running", "displayString": "Running"}}}, "pump1pumpTargetRPM": {"type": "uiFloatParam", "name": "pump1pumpTargetRPM", "displayString": "Target RPM", "verboseString": "Pump 1 RPM", "min": 800, "max": 2000}}}, "pump2_submodule": {"type": "uiSubmodule", "name": "pump2_submodule", "displayString": "Pump 2", "children": {"pump2pumprpm": {"type": "uiVariable", "name": "pump2pumprpm", "displayString": "Engine RPM", "form": "radialGauge", "varType": "float", "decPrecision": 0, "ranges": [{"label": None, "min": 0, "max": 800, "colour": "blue", "showOnGraph": True}, {"label": None, "min": 800, "max": 2200, "colour": "green", "showOnGraph": True}]}, "pump2pumpprime": {"type": "uiVariable", "name": "pump2pumpprime", "displayString": "Pump Primed", "varType": "bool"}, "pump2engineLoad": {"type": "uiVariable", "name": "pump2engineLoad", "displayString": "Engine Load (%)", "varType": "float", "decPrecision": 0, "ranges": [{"label": None, "min": 0, "max": 15, "colour": "blue", "showOnGraph": True}, {"label": None, "min": 15, "max": 100, "colour": "green", "showOnGraph": True}]}, "pump2coolantTemp": {"type": "uiVariable", "name": "pump2coolantTemp", "displayString": "Coolant Temp (C)", "varType": "float", "decPrecision": 0, "ranges": [{"label": "Cool", "min": 0, "max": 50, "colour": "blue", "showOnGraph": True}, {"label": "Good", "min": 50, "max": 90, "colour": "green", "showOnGraph": True}, {"label": "Hot", "min": 90, "max": 120, "colour": "yellow", "showOnGraph": True}]}, "pump2fuelRate": {"type": "uiVariable", "name": "pump2fuelRate", "displayString": "Fuel Rate (l/hr)", "varType": "float", "decPrecision": 1}, "pump2sysVolts": {"type": "uiVariable", "name": "pump2sysVolts", "displayString": "System Voltage", "varType": "float", "decPrecision": 1}, "pump2engineHours": {"type": "uiVariable", "name": "pump2engineHours", "displayString": "Engine Hours", "varType": "float", "decPrecision": 1}, "pump2pumpState": {"type": "uiStateCommand", "name": "pump2pumpState", "displayString": "Pump Should Be", "verboseString": "Pump 2", "userOptions": {"shutdown": {"type": "uiElement", "name": "shutdown", "displayString": "Shutdown"}, "running": {"type": "uiElement", "name": "running", "displayString": "Running"}}}, "pump2pumpTargetRPM": {"type": "uiFloatParam", "name": "pump2pumpTargetRPM", "displayString": "Target RPM", "verboseString": "Pump 2 RPM", "min": 800, "max": 2000}}}, "pump3_submodule": {"type": "uiSubmodule", "name": "pump3_submodule", "displayString": "Pump 3", "children": {"pump3pumprpm": {"type": "uiVariable", "name": "pump3pumprpm", "displayString": "Engine RPM", "form": "radialGauge", "varType": "float", "decPrecision": 0, "ranges": [{"label": None, "min": 0, "max": 800, "colour": "blue", "showOnGraph": True}, {"label": None, "min": 800, "max": 2200, "colour": "green", "showOnGraph": True}]}, "pump3pumpprime": {"type": "uiVariable", "name": "pump3pumpprime", "displayString": "Pump Primed", "varType": "bool"}, "pump3engineLoad": {"type": "uiVariable", "name": "pump3engineLoad", "displayString": "Engine Load (%)", "varType": "float", "decPrecision": 0, "ranges": [{"label": None, "min": 0, "max": 15, "colour": "blue", "showOnGraph": True}, {"label": None, "min": 15, "max": 100, "colour": "green", "showOnGraph": True}]}, "pump3coolantTemp": {"type": "uiVariable", "name": "pump3coolantTemp", "displayString": "Coolant Temp (C)", "varType": "float", "decPrecision": 0, "ranges": [{"label": "Cool", "min": 0, "max": 50, "colour": "blue", "showOnGraph": True}, {"label": "Good", "min": 50, "max": 90, "colour": "green", "showOnGraph": True}, {"label": "Hot", "min": 90, "max": 120, "colour": "yellow", "showOnGraph": True}]}, "pump3fuelRate": {"type": "uiVariable", "name": "pump3fuelRate", "displayString": "Fuel Rate (l/hr)", "varType": "float", "decPrecision": 1}, "pump3sysVolts": {"type": "uiVariable", "name": "pump3sysVolts", "displayString": "System Voltage", "varType": "float", "decPrecision": 1}, "pump3engineHours": {"type": "uiVariable", "name": "pump3engineHours", "displayString": "Engine Hours", "varType": "float", "decPrecision": 1}, "pump3pumpState": {"type": "uiStateCommand", "name": "pump3pumpState", "displayString": "Pump Should Be", "verboseString": "Pump 3", "userOptions": {"shutdown": {"type": "uiElement", "name": "shutdown", "displayString": "Shutdown"}, "running": {"type": "uiElement", "name": "running", "displayString": "Running"}}}, "pump3pumpTargetRPM": {"type": "uiFloatParam", "name": "pump3pumpTargetRPM", "displayString": "Target RPM", "verboseString": "Pump 3 RPM", "min": 800, "max": 2000}}}}}}}}

print(ui_manager.get_json_update(current, desired))

print("Test complete")